/*

 JS Signals <http://millermedeiros.github.com/js-signals/>
 Released under the MIT license
 Author: Miller Medeiros
 Version: 0.7.1 - Build: 244 (2011/11/29 12:33 PM)
*/
(function(g){function f(a,b,d,h,c){this._listener=b;this._isOnce=d;this.context=h;this._signal=a;this._priority=c||0}function e(a,b){if(typeof a!=="function")throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));}var c={VERSION:"0.7.1"};f.prototype={active:!0,params:null,execute:function(a){var b;this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,a),this._isOnce&&this.detach());return b},detach:function(){return this.isBound()?
this._signal.remove(this._listener):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};c.Signal=function(){this._bindings=[];this._prevParams=null};c.Signal.prototype={memorize:!1,_shouldPropagate:!0,
active:!0,_registerListener:function(a,b,d,c){var e=this._indexOfListener(a);if(e!==-1){if(a=this._bindings[e],a.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(!b?"":"Once")+"() the same listener without removing the relationship first.");}else a=new f(this,a,b,d,c),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);
this._bindings.splice(b+1,0,a)},_indexOfListener:function(a){for(var b=this._bindings.length;b--;)if(this._bindings[b]._listener===a)return b;return-1},has:function(a){return this._indexOfListener(a)!==-1},add:function(a,b,d){e(a,"add");return this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){e(a,"addOnce");return this._registerListener(a,!0,b,d)},remove:function(a){e(a,"remove");var b=this._indexOfListener(a);b!==-1&&(this._bindings[b]._destroy(),this._bindings.splice(b,1));return a},removeAll:function(){for(var a=
this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b=Array.prototype.slice.call(arguments),d=this._bindings.length,c;if(this.memorize)this._prevParams=b;if(d){c=this._bindings.slice();this._shouldPropagate=!0;do d--;while(c[d]&&this._shouldPropagate&&c[d].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();
delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};typeof define==="function"&&define.amd?define("signals",[],c):typeof module!=="undefined"&&module.exports?module.exports=c:g.signals=c})(this);
/*!
 * Hasher <http://github.com/millermedeiros/hasher>
 * @author Miller Medeiros
 * @version 1.1.0 (2011/11/01 07:15 PM)
 * Released under the MIT License
 */
(function(a){a("hasher",["signals"],function(b){var c=(function(l){var p=25,r=l.document,d=l.location,o=l.history,w=b.Signal,g,v,n,E,f,C,t=/#(.*)$/,k=/(\?.*)|(\#.*)/,h=/^\#/,j=(!+"\v1"),A=("onhashchange" in l),e=j&&!A,s=(d.protocol==="file:");function u(G){if(!G){return""}var F=new RegExp("^\\"+g.prependHash+"|\\"+g.appendHash+"$","g");return G.replace(F,"")}function D(){var F=t.exec(g.getURL());return(F&&F[1])?decodeURIComponent(F[1]):""}function z(){return(f)?f.contentWindow.frameHash:null}function y(){f=r.createElement("iframe");f.src="about:blank";f.style.display="none";r.body.appendChild(f)}function i(){if(f&&v!==z()){var F=f.contentWindow.document;F.open();F.write("<html><head><title>"+r.title+'</title><script type="text/javascript">var frameHash="'+v+'";<\/script></head><body>&nbsp;</body></html>');F.close()}}function m(F,G){F=decodeURIComponent(F);if(v!==F){var H=v;v=F;if(e){if(!G){i()}else{f.contentWindow.frameHash=F}}g.changed.dispatch(u(F),u(H))}}if(e){C=function(){var G=D(),F=z();if(F!==v&&F!==G){g.setHash(u(F))}else{if(G!==v){m(G)}}}}else{C=function(){var F=D();if(F!==v){m(F)}}}function B(H,F,G){if(H.addEventListener){H.addEventListener(F,G,false)}else{if(H.attachEvent){H.attachEvent("on"+F,G)}}}function x(H,F,G){if(H.removeEventListener){H.removeEventListener(F,G,false)}else{if(H.detachEvent){H.detachEvent("on"+F,G)}}}function q(G){G=Array.prototype.slice.call(arguments);var F=G.join(g.separator);F=F?g.prependHash+F.replace(h,"")+g.appendHash:F;if(j&&s){F=F.replace(/\?/,"%3F")}return F}g={VERSION:"1.1.0",appendHash:"",prependHash:"/",separator:"/",changed:new w(),stopped:new w(),initialized:new w(),init:function(){if(E){return}v=D();if(A){B(l,"hashchange",C)}else{if(e){if(!f){y()}i()}n=setInterval(C,p)}E=true;g.initialized.dispatch(u(v))},stop:function(){if(!E){return}if(A){x(l,"hashchange",C)}else{clearInterval(n);n=null}E=false;g.stopped.dispatch(u(v))},isActive:function(){return E},getURL:function(){return d.href},getBaseURL:function(){return g.getURL().replace(k,"")},setHash:function(F){F=q.apply(null,arguments);if(F!==v){m(F);d.hash="#"+encodeURI(F)}},replaceHash:function(F){F=q.apply(null,arguments);if(F!==v){m(F,true);d.replace("#"+encodeURI(F))}},getHash:function(){return u(v)},getHashAsArray:function(){return g.getHash().split(g.separator)},dispose:function(){g.stop();g.initialized.dispose();g.stopped.dispose();g.changed.dispose();f=g=l.hasher=null},toString:function(){return'[hasher version="'+g.VERSION+'" hash="'+g.getHash()+'"]'}};g.initialized.memorize=true;return g}(window));return c})}(typeof define==="function"&&define.amd?define:function(c,b,a){window[c]=a(window[b[0]])}));
